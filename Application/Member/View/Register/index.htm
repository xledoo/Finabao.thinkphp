
<!-- BEGIN BREADCRUMBS -->   
    <div class="row breadcrumbs margin-bottom-40">
        <div class="container">
            <div class="col-md-4 col-sm-4">
                <h1>Register 会员注册</h1>
            </div>
            <div class="col-md-8 col-sm-8">
                    <ul class="pull-right breadcrumb">
                        <li><a href="{:U('Home/Index/index')}">首页</a></li>
                        <li><a href="{:U('Member/Index/index')}">会员中心</a></li>
                        <li class="active">会员注册</li>
                    </ul>
            </div>
        </div>
    </div>
<!-- END BREADCRUMBS -->


<!-- BEGIN CONTAINER -->   
    <div class="container margin-bottom-40">
    	<!--/row-->
        <div class="row">
            <form action="{:U('Member/Register/Submit')}" id="register_form" method="post" class="form-horizontal">
                <input type="hidden" name="formhash" value="{$formhash}">
				<div class="col-md-4">
					<div class="row">
						<img src="assets/img/photos/img4.jpg">
					</div>
				</div>
				<div class="col-md-8">
					<div class="row">
						<div class="col-md-6">
							<div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
			                    <input type="text" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="用户名" nullmsg="请填写用户名" datatype="s5-15" errormsg="用户名至少5个字符,最多15个字符！" name="username" id="username" >
			                </div>
			            	<div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="fa fa-lock"></i></span>
			                    <input type="password" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="密码" name="password" id="password" >
			                </div>
			                <div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="fa fa-lock"></i></span>
			                    <input type="password" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="确认密码" name="password2" id="password2">
			                </div>
						</div>
						<div class="col-md-6">
							<div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
			                    <input type="text" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="邮箱" name="email" id="email">
			                </div>
			            	<div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="fa fa-apple"></i></span>
			                    <input type="text" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="手机号码" name="mobile" id="mobile">
			                </div>
			                <div class="input-group margin-bottom-20">
			                    <span class="input-group-addon"><i class="glyphicon glyphicon-qrcode"></i></span>
			                    <input type="text" class="form-control" onblur="ajax_check(this.id, this.value);" placeholder="短信验证码" name="sign" id="sign">
			                    <span class="input-group-btn"><button class="btn btn-info green" type="button" style="position:absolute; top:0px; _position:relative; _height:34px; _top:-36px; _left:110px;" id="smscheck">短信验证码</button></span>
			                </div>
						</div>
						<div class="col-md-12">
						<input type="submit" class="btn btn-info green col-md-12" name="register" value="提交注册" id="register_submit">						</div>
					</div>
				</div>	            	
            </form>
        </div>
    </div>
<!-- END CONTAINER -->

<script type="text/javascript">
function ajax_check(id, val){
	jQuery.getJSON('index.php?m=member&c=register&a=ajax_check&type='+id+'&data='+val, function(json){
		var pre = jQuery("#" + id).parent().attr('class');

		if(json['error'] == 0){
			//jQuery('#' + id)[0].parentNode.className = jQuery('#' + id)[0].parentNode.className.replace(json['class']);
			jQuery("#" + id).parent().toggleClass(json['class'])
			
			// var aft = pre + json['class'];

			// alert(aft);
			// alert(jQuery("#" + id)[0].parentNode.className);
			

			//二次密码确认
			if(id == 'password2'){
				// alert(json['data']);exit();
				if(json['data'] == jQuery("#password").val()){
					alert('密码确认成功！');
				} else {
					aft = pre + ' has-error';
					alert(aft);
					alert('两次密码不一致！');

				}
			}
			
			alert(json['message']);
		} else {
			// jQuery('#' + id)[0].parentNode.className = jQuery('#' + id)[0].parentNode.className.replace(json['class']);

			jQuery("#" + id).parent().toggleClass(json['class']);

			var aft = pre + json['class'];

			alert(aft);
			// alert(jQuery("#" + id).parent().attr("class"));
			// alert(jQuery("#" + id)[0].parentNode.className);
			alert(json['message']);
		}

		
	});
	return false;
}
jQuery("#register_form").submit(function(){
	jQuery(".form-control").each(function(i){
		if(this.id){
			if(!this.className.match(/ has-success/)){
				jQuery(".input-group input").eq(i).focus();
				err = 1;
				return false;
			}
		}
	});
	return false;	
});

</script>

</div>
<!-- END PAGE CONTAINER -->


